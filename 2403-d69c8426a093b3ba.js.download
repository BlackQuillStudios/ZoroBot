"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2403],{61390:function(e,t,r){r.d(t,{l:function(){return c}});var a=r(17663),o=r(56283),n=r(10355),s=r(24353),i=r(82403);let l=(0,o.B)("FormLabelRequiredText",{root:Object.assign(Object.assign({},i.ZT.smallPrint1),{color:s.w.neutral700,textTransform:"lowercase","&::before":{content:'"("'},"&::after":{content:'")"'},'&[data-state="disabled"]':{color:s.w.neutral500}})}),u=({children:e="Required",isDisabled:t=!1})=>(0,n.U)("span",{"aria-hidden":"true",css:l.root,"data-state":t?"disabled":void 0},e),d=(0,o.B)("FormLabel",{root:a.iv`
    display: grid;
    justify-content: start;
    grid-gap: 5px;
    grid-auto-flow: column;
    grid-auto-columns: auto;
    cursor: pointer;
    color: ${s.w.neutral700};

    &[data-align-items='center'] {
      align-items: center;
    }

    &[data-align-items='start'] {
      align-items: start;
    }

    &[data-justify-content='start'] {
      justify-content: start;
    }

    &[data-justify-content='stretch'] {
      justify-content: stretch;
    }

    &[data-state~='selected'] {
      color: ${s.w.blue};
    }

    &[data-state~='errored'] {
      color: ${s.w.error400};
    }

    &[data-state~='disabled'] {
      cursor: not-allowed;
    }

    &[data-state~='disabled'] {
      color: ${s.w.neutral500};
    }

    &[data-size='small'] {
      ${i.ZT.smallPrint1Semibold};
    }

    &[data-size='medium'] {
      ${i.ZT.paragraph3Medium};
    }

    &[data-size='medium'][data-state='selected'] {
      ${i.ZT.paragraph3Semibold}
    }
  `}),c=({children:e,alignItems:t="center",htmlFor:r,isDisabled:a,isErrored:o,isRequired:s,isSelected:i,justifyContent:l="start",requiredText:c,size:f="medium"})=>(0,n.U)("label",{css:d.root,"data-align-items":t,"data-justify-content":l,"data-size":f,"data-state":[i&&"selected",o&&"errored",a&&"disabled"].filter(Boolean).join(" ")||void 0,htmlFor:r},s&&"*",e,s?c?(0,n.U)(u,{isDisabled:a},c):(0,n.U)(u,{isDisabled:a}):null)},54191:function(e,t,r){r.d(t,{T:function(){return a}});function a(e){if(void 0!==e.ZodType.prototype.openapi)return;e.ZodType.prototype.openapi=function(e){let t=new this.constructor({...this._def,openapi:e});return t};let t=e.ZodObject.prototype.extend;e.ZodObject.prototype.extend=function(...e){let r=t.apply(this,e);return r._def.extendMetadata={extends:this},delete r._def.openapi,r};let r=e.ZodObject.prototype.omit;e.ZodObject.prototype.omit=function(...e){let t=r.apply(this,e);return delete t._def.extendMetadata,delete t._def.openapi,t};let a=e.ZodObject.prototype.pick;e.ZodObject.prototype.pick=function(...e){let t=a.apply(this,e);return delete t._def.extendMetadata,delete t._def.openapi,t}}},14225:function(e,t,r){let a;r.d(t,{bI:function(){return en},Tc:function(){return V},TY:function(){return l},nX:function(){return A},Pi:function(){return p},Vy:function(){return c}});var o=r(79884),n=r(66970),s=r(1850),i=r(54191);let l={Chatbot:"Chatbot",Config:"Config",Content:"Content",Data:"Data",Actions:"Actions",Embed:"Embed","Generated from prompt:":"Generated from prompt:","Chatbot name":"Chatbot name","Build an AI-powered chatbot.":"Build an AI-powered chatbot.","Say hello and tell me what you can do.":"Say hello and tell me what you can do.","How can I help you today?":"How can I help you today?","Ask me anything":"Ask me anything","You are an AI chatbot. You are a helpful assistant.":"You are an AI chatbot. You are a helpful assistant.","Sorry, I don’t know.":"Sorry, I don’t know.","URL must be at least 4 characters":"URL must be at least 4 characters","This field is required":"This field is required","This field must be no more than {{count}} characters":"This field must be no more than {{count}} characters","Action triggered!":"Action triggered!","User gets a response":"User gets a response","Display a button":"Display a button","Copy response":"Copy response","Run Zap":"Run Zap","No response was generated.":"No response was generated.","Unknown error occurred":"Unknown error occurred","You've reached the chat completion limit for this session.":"You've reached the chat completion limit for this session.","Something went wrong.":"Something went wrong.","Hmm, things are taking a bit too long. You can try again, or try a different question.":"Hmm, things are taking a bit too long. You can try again, or try a different question.","Chatbot is responding...":"Chatbot is responding...",Send:"Send",Close:"Close",Loading:"Loading","This response is helpful":"This response is helpful","This response is not helpful":"This response is not helpful","Rating feedback":"Rating feedback","Submit feedback":"Submit feedback","What do you like about the response?":"What do you like about the response?","What do you dislike about the response?":"What do you dislike about the response?","This is an automated chatbot response. [Learn more](https://zapier.com/legal/terms-of-service)":"This is an automated chatbot response. [Learn more](https://zapier.com/legal/terms-of-service)","Prompt input provided to the response above":"Prompt input provided to the response above","Response generated to the prompt input above":"Response generated to the prompt input above","This is a demo response":"This is a demo response","Greeting generated from prompt":"Greeting generated from prompt","Thanks for the feedback!":"Thanks for the feedback!","Jump to latest":"Jump to latest",Height:"Height","Prompt placeholder":"Prompt placeholder",Greeting:"Greeting","This will be the first message the user sees.":"This will be the first message the user sees.","The chatbot will generate the first message the user sees based on its directive and this prompt.":"The chatbot will generate the first message the user sees based on its directive and this prompt.",Directive:"Directive","Tell the bot how you’d like it to respond. You can include style, tone, accent, and more.":"Tell the bot how you’d like it to respond. You can include style, tone, accent, and more.","Disclosure message":"Disclosure message","Required for Zapier employees.":"Required for Zapier employees.","Data sources":"Data sources","This input accepts markdown links.":"This input accepts markdown links.","OpenAI authentication":"OpenAI authentication","This authentication isn’t working.":"This authentication isn’t working.","List of connected OpenAI authentications":"List of connected OpenAI authentications",Model:"Model","List of available GPT models":"List of available GPT models","Model availability depends on the selected authentication.":"Model availability depends on the selected authentication.","When results are not found from the data source":"When results are not found from the data source","Generate an AI response without data sources":"Generate an AI response without data sources","Show a custom message":"Show a custom message",Sources:"Sources","No data sources":"No data sources","Custom message":"Custom message","List of behaviors when no results are found from the data source":"List of behaviors when no results are found from the data source","This defines the experience when results are not found from the data source.":"This defines the experience when results are not found from the data source.","Source material":"Source material","Add data sources to teach your chatbot anything it doesn’t already know.":"Add data sources to teach your chatbot anything it doesn’t already know.","Deleting...":"Deleting...","Delete data source":"Delete data source","Are you sure? You’ll no longer be able to use this data source.":"Are you sure? You’ll no longer be able to use this data source.","Replace data source":"Replace data source","You’ve reached the maximum number of sources.":"You’ve reached the maximum number of sources.","Add source":"Add source","Preview data source chunks":"Preview data source chunks","Show all chunks ({{count}})":"Show all chunks ({{count}})","Max response length (tokens)":"Max response length (tokens)","The default setting is {{contextLimit}} max tokens used per response for this model.":"The default setting is {{contextLimit}} max tokens used per response for this model.","Set the max length for individual chatbot responses. The max setting available for this model is {{contextLimit}} tokens.":"Set the max length for individual chatbot responses. The max setting available for this model is {{contextLimit}} tokens.","this model":"this model","Only the project owner can manage the Chatbot’s authentication.":"Only the project owner can manage the Chatbot’s authentication.","Save changes":"Save changes","Cannot be lower than {{count}}.":"Cannot be lower than {{count}}.","Cannot be higher than {{count}}.":"Cannot be higher than {{count}}.",Creativity:"Creativity",Predictable:"Predictable",Random:"Random","Reset to default":"Reset to default","Connect a custom data source":"Connect a custom data source","Upload a file with your own knowledge to tailor the AI Chatbot responses for your business or project.":"Upload a file with your own knowledge to tailor the AI Chatbot responses for your business or project.","Current functionality includes the ability to upload one 1MB static text file (.txt, .csv, .json, .pdf, .doc, .docx).":"Current functionality includes the ability to upload one 1MB static text file (.txt, .csv, .json, .pdf, .doc, .docx).",Upgrade:"Upgrade","Trigger actions from chatbot responses":"Trigger actions from chatbot responses","gets a response":"gets a response","Setup automations that trigger available actions directly in chat.":"Setup automations that trigger available actions directly in chat.","Add action":"Add action","Use Case":"Use Case","The user’s full name":"The user’s full name","The user’s primary contact email address. Must resemble a valid email address.":"The user’s primary contact email address. Must resemble a valid email address.","The name of the company represented by the user’s inquiry":"The name of the company represented by the user’s inquiry","Unable to parse OpenAI response with Zod schema":"Unable to parse OpenAI response with Zod schema"};(0,i.T)(s.z);let u=s.z.enum(["gpt-3.5-turbo","gpt-3.5-turbo-16k","gpt-4","gpt-4-32k"]),d=(s.z.object({label:s.z.string(),value:u,contextLimit:s.z.number().int(),requiresUpgrade:s.z.boolean().default(!0),supportedVersion:s.z.string()}),{GPT3:{label:"OpenAI GPT-3.5",value:"gpt-3.5-turbo",contextLimit:4096,requiresUpgrade:!1,supportedVersion:"0613"},GPT3_16k:{label:"OpenAI GPT-3.5 (16k)",value:"gpt-3.5-turbo-16k",contextLimit:16384,requiresUpgrade:!0,supportedVersion:"0613"},GPT4:{label:"OpenAI GPT-4",value:"gpt-4",contextLimit:8192,requiresUpgrade:!0,supportedVersion:"0613"},GPT4_32k:{label:"OpenAI GPT-4 (32k)",value:"gpt-4-32k",contextLimit:32768,requiresUpgrade:!0,supportedVersion:"0613"}}),c=(Object.values(d).filter(e=>!e.requiresUpgrade),Object.values(d).filter(e=>e.requiresUpgrade),e=>{let t=Object.values(d).find(t=>t.value===e);if(!t)throw Error(`ChatModel with name "${e}" not found`);return t}),f=s.z.discriminatedUnion("role",[s.z.object({content:s.z.string(),role:s.z.literal("system"),name:s.z.string().optional()}),s.z.object({content:s.z.string(),role:s.z.literal("assistant"),name:s.z.string().optional()}),s.z.object({content:s.z.string(),role:s.z.literal("user"),name:s.z.string().optional()}),s.z.object({content:s.z.string(),role:s.z.literal("function"),name:s.z.string()})]),p=(s.z.object({name:s.z.string(),description:s.z.string(),parameters:s.z.object({type:s.z.literal("object"),properties:s.z.record(s.z.object({type:s.z.string(),description:s.z.string(),enum:s.z.string().array().optional()})),required:s.z.string().array()}).optional()}),s.z.object({id:s.z.string().cuid().or(s.z.string().regex(/^_ACTION_(\d+)$/)).optional(),userEvent:s.z.literal("response"),action:s.z.literal("button"),buttonText:s.z.string().min(1,l["This field is required"]).max(30,l["This field must be no more than {{count}} characters"].replace("{{count}}","30")),onClick:s.z.union([s.z.literal("copy"),s.z.literal("zap")]),notificationText:s.z.string().min(1,l["This field is required"]).max(50,l["This field must be no more than {{count}} characters"].replace("{{count}}","50")).optional().default(l["Action triggered!"])})),m=p.required(),h=s.z.object({type:s.z.literal("chatbot-button"),config:p}),g=s.z.discriminatedUnion("type",[h]),b=s.z.object({response:s.z.string(),chatbotName:s.z.string().optional(),prompt:s.z.string().optional()}),y=s.z.object({message:s.z.string(),rating:s.z.number().min(-1).max(1),comment:s.z.string().optional(),conversation:s.z.array(f)}),v=s.z.object({type:s.z.literal("ChatbotButtonClick"),blockActionId:s.z.string().cuid(),values:b}),x=s.z.object({type:s.z.literal("ChatbotFeedback"),blockId:s.z.string().cuid(),chatbotSessionId:s.z.string().cuid(),values:y}),z=(s.z.discriminatedUnion("type",[v,x]),s.z.object({accountId:s.z.string(),projectId:s.z.string().optional(),pageId:s.z.string().optional(),blockId:s.z.string(),name:s.z.string(),reference:s.z.string(),text:s.z.string()})),w=s.z.object({id:s.z.string().cuid(),description:s.z.string().optional().default(""),splitStrategy:s.z.enum(["auto","delimiter","ai","manual"]).optional().default("auto"),splitValue:s.z.string().optional().default(""),chunks:s.z.array(s.z.object({id:s.z.string(),metadata:z})).optional().default([])}),_=w.extend({dataType:s.z.literal("table"),reference:s.z.string().min(26).max(26),name:s.z.string()}),S=w.extend({dataType:s.z.literal("file"),reference:s.z.string().url(),name:s.z.string()}),k=w.extend({dataType:s.z.literal("url"),reference:s.z.string().min(4,{message:l["URL must be at least 4 characters"]}),name:s.z.string()}),A=s.z.discriminatedUnion("dataType",[_,S,k]),T=s.z.object({functionName:s.z.string(),description:s.z.string().optional(),zapId:s.z.number(),zapInput:s.z.record(s.z.string(),s.z.object({description:s.z.string().optional(),shouldGuess:s.z.boolean().default(!0),staticValue:s.z.string().optional(),required:s.z.boolean().default(!0)})).optional().default({})}),j=s.z.object({width:s.z.union([s.z.literal("full"),s.z.literal("wide"),s.z.literal("medium"),s.z.literal("narrow")]).optional(),alignment:s.z.union([s.z.literal("left"),s.z.literal("center"),s.z.literal("right")]).optional(),height:s.z.union([s.z.literal("default"),s.z.literal("custom")]).optional(),heightValue:s.z.number().optional()}),C=s.z.object({name:s.z.enum(["name","email","company"]),fieldKey:s.z.string().nullable().default(null)}),F=s.z.object({chatbotName:s.z.string().optional().default(l.Chatbot),defaultMessageMode:s.z.enum(["static","generated"]).optional().default("static"),defaultPrompt:s.z.string().optional().default(l["Say hello and tell me what you can do."]),defaultMessage:s.z.string().optional().default(l["How can I help you today?"]),placeholder:s.z.string().optional().default(l["Ask me anything"]),directive:s.z.string().optional().default(l["You are an AI chatbot. You are a helpful assistant."]),useDirectiveToAlterDefaultMessage:s.z.boolean().optional().default(!0),authenticationId:s.z.string().optional().default(""),model:u.optional().default("gpt-3.5-turbo"),maxTokens:s.z.coerce.number().int().optional().default(2048),temperature:s.z.number().min(0).max(1).optional().default(.7),collectUserData:s.z.boolean().default(!1),collectUserDataTemplate:s.z.enum(["lead_generation","support","feedback"]).optional().default("lead_generation"),collectUserDataTableId:s.z.string().optional(),collectUserDataFields:s.z.array(C).optional().default([{name:"name"},{name:"email"},{name:"company"}]),style:j.optional().default({width:"medium",alignment:"center",height:"default"}),triggers:s.z.array(g).default([]),displayDisclosure:s.z.boolean().default(!0),disclosureText:s.z.string().optional().default(l["This is an automated chatbot response. [Learn more](https://zapier.com/legal/terms-of-service)"]),dataSources:s.z.array(A).optional().default([]),dataSourcesMaxResults:s.z.number().int().min(1).max(5).optional().default(5),dataSourcesResultsQuality:s.z.number().min(.6).max(.95).optional().default(.6),dataSourcesMode:s.z.enum(["source","chatgpt"]).optional().default("chatgpt"),dataSourcesNoResultsMode:s.z.enum(["custom","chatgpt"]).optional().default("chatgpt"),dataSourcesNoResultsMessage:s.z.string().optional().default(l["Sorry, I don’t know."]),zapFunctions:s.z.array(T).default([]).optional(),embedHosts:s.z.string().array().optional().default([]),restrictEmbedDomains:s.z.boolean().optional().default(!1)});F.omit({triggers:!0}).extend({chatbotSessionId:s.z.string().cuid(),isStaticMode:s.z.boolean(),triggers:s.z.array(m).default([]),user:s.z.string().optional()});let D=F.extend({id:s.z.string().cuid().or(s.z.string().regex(/^_BLOCK_(\d+)$/)).optional(),chatbotId:s.z.string().cuid().or(s.z.string().regex(/\$\{\{ *([A-Za-z0-9_.]+) *\}\}/g)).optional(),isConnectedChatbot:s.z.boolean().optional().default(!1)}),V=s.z.object({type:s.z.literal("chatbot-block"),config:D,errors:s.z.array(s.z.object({code:s.z.enum(["chatbot:authentication-does-not-exist","chatbot:authentication-test-failed","chatbot:model-not-available","chatbot:max-tokens-too-high","chatbot:chatbot-does-not-exist"]),blockId:s.z.string().nullable(),path:s.z.array(s.z.union([s.z.string(),s.z.number()]))})).optional()}),I=(0,n.createContext)(null);function O({children:e,...t}){let r=(0,n.useMemo)(()=>{var e;let r=F.parse(t.config);return{...t,...r,isStaticMode:"static"===r.defaultMessageMode,triggers:(r.triggers??[]).map(e=>e.config),user:null==(e=t.accountId)?void 0:e.toString()}},[t]);return(0,o.jsx)(I.Provider,{value:r,children:e})}function E(){let e=(0,n.useContext)(I);if(null===e)throw Error("useChatbotContext must be used within a ChatbotContextProvider");return e}function U({message:e,children:t,...r}){let{onEvent:a,projectId:n,pageId:s,isEmbedded:i,botActionSlot:l}=E();return(0,o.jsx)(l,{...r,type:"button",onClick:t=>{navigator.clipboard.writeText(e.content?e.content:"").catch(e=>{console.warn("Failed to copy text: ",e)}).finally(()=>{var e;a({interaction_goal:"copy bot response",event_action:"click",interfaces_project_id:n,interfaces_page_id:s,interfaces_component_type:"chatbot",embedded_flag:i}),null==(e=r.onClick)||e.call(r,t)})},children:t})}function R({children:e,message:t,...r}){let{onEvent:a,projectId:n,pageId:s,isEmbedded:i,botActionSlot:l}=E();return(0,o.jsx)(l,{...r,type:"button",onClick:e=>{var o;null==(o=r.onClick)||o.call(r,e),a({interaction_raw_text:t.content,interaction_goal:"run zap with bot response",event_action:"click",interfaces_project_id:n,interfaces_page_id:s,interfaces_component_type:"chatbot",embedded_flag:i})},children:e})}var L=r(57203);let M="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var P={randomUUID:M};let N=new Uint8Array(16);function B(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(N)}let q=[];for(let e=0;e<256;++e)q.push((e+256).toString(16).slice(1));var G=function(e,t,r){if(P.randomUUID&&!t&&!e)return P.randomUUID();e=e||{};let a=e.random||(e.rng||B)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(q[e[t+0]]+q[e[t+1]]+q[e[t+2]]+q[e[t+3]]+"-"+q[e[t+4]]+q[e[t+5]]+"-"+q[e[t+6]]+q[e[t+7]]+"-"+q[e[t+8]]+q[e[t+9]]+"-"+q[e[t+10]]+q[e[t+11]]+q[e[t+12]]+q[e[t+13]]+q[e[t+14]]+q[e[t+15]]).toLowerCase()}(a)};let Y=s.z.object({id:s.z.string(),object:s.z.string(),created:s.z.number(),model:s.z.string(),choices:s.z.array(s.z.object({index:s.z.number().int(),message:s.z.object({role:s.z.string(),content:s.z.string()}),finish_reason:s.z.string().nullable()})),usage:s.z.object({prompt_tokens:s.z.number().int(),completion_tokens:s.z.number().int(),total_tokens:s.z.number().int()})}),Z=s.z.object({code:s.z.string(),error:s.z.string(),message:s.z.string().optional(),meta:s.z.object({code:s.z.string(),message:s.z.string(),param:s.z.string(),type:s.z.string()}).partial().passthrough().optional()}).passthrough(),$=Symbol("interfaces-chat-error-code"),W=Symbol("interfaces-chat-error-message"),H=function(e,t){let r=Error(e);return Object.defineProperty(r,$,{get:()=>t}),Object.defineProperty(r,W,{get:()=>e}),Error.captureStackTrace&&Error.captureStackTrace(r,H),r},K=e=>e[$],X=e=>e[W];function J(e){let{apiEndpoint:t="/api/chat/v2",idField:r="blockId",chatbotSessionId:a,config:{model:o},onUsage:s,fetcher:i}=E(),u=(0,n.useRef)(""),[d,c]=(0,n.useState)("");return[async function(n){var d,f;try{if(!(r in n))throw Error("Missing blockId/chatbotId");c(()=>""),null==e||e(""),u.current="";let p=new AbortController,{signal:m}=p,h=setTimeout(()=>p.abort(),15e3),g=await i(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...n,chatbotSessionId:a}),signal:m});if(clearTimeout(h),!g.ok){let e=await g.json(),t=Z.safeParse(e);throw t.success?H((null==(d=t.data.meta)?void 0:d.message)??t.data.error,(null==(f=t.data.meta)?void 0:f.code)??t.data.code):H(g.statusText,g.statusText.toLowerCase().replace(/\s/g,"_"))}let b=g.headers.get("x-interfaces-prediction-id")??G();if("application/json"===g.headers.get("content-type")){let t=Y.safeParse(await g.json());if(!t.success)throw H(t.error.issues[0].message??l["Unable to parse OpenAI response with Zod schema"],t.error.issues[0].code??"");let{choices:[{message:{content:r}}],usage:a}=t.data,i=r.replace(/^[\n\r]+/g,"");i&&(u.current=u.current+i,c(t=>{let r=t+i;return r.startsWith("[ERROR]")||null==e||e(r),r})),s(o,n.messages,u.current,a)}else{let t=g.body;if(!t)throw H(l["No response was generated."],"no_data");let r=t.getReader(),a=new TextDecoder,i=!1;for(;!i;){let{value:t,done:o}=await r.read();i=o;let n=a.decode(t);n&&(u.current=u.current+n,c(t=>{let r=t+n;return r.startsWith("[ERROR]")||null==e||e(r),r}))}s(o,n.messages,u.current)}if(u.current.startsWith("[ERROR]")){let{error:e,code:t}=Z.parse(JSON.parse(u.current.replace("[ERROR]","").trim()));throw u.current="",H(e??l["Unknown error occurred"],t)}if(u.current.endsWith("[max_completion_limit]"))throw u.current="",H(l["You've reached the chat completion limit for this session."],"max_completion_limit");return{status:"complete",code:"success",predictionId:b}}catch(o){console.error(o);let e=o instanceof DOMException&&"AbortError"===o.name,t=X(o),r=(e?"timeout":K(o))??"unknown",a=l["Something went wrong."];return e?a=l["Hmm, things are taking a bit too long. You can try again, or try a different question."]:t&&(a=t),u.current=a,{status:"error",code:r,predictionId:G()}}},u,d]}function Q(){}let ee={role:"user",content:""};function et({isDisabled:e=!1,onChatComplete:t=Q,onError:r=Q,messages:a=[],onSubmitPrompt:s=Q,onLiveBotResponseUpdated:i=Q}){var u;let d=(0,n.useRef)(null),c=null==(u=d.current)?void 0:u.querySelector("textarea"),{idField:f="blockId",blockId:p,placeholder:m,onEvent:h,hideZapierButton:g,isEmbedded:b,isPopup:y,pageId:v,projectId:x,renderPoweredByZapier:z,userPromptSlot:w,onChatError:_}=E(),[S,k]=J(i),{register:A,handleSubmit:T,reset:j,resetField:C,setFocus:F,setValue:D,formState:{isSubmitting:V,isSubmitSuccessful:I}}=(0,L.cI)({defaultValues:ee}),[O,U]=(0,n.useState)(""),R=e=>{var t,r;"Enter"!==e.key||e.shiftKey||(e.preventDefault(),null==(r=null==(t=d.current)?void 0:t.querySelector("button"))||r.click())},M=(0,n.useCallback)(async e=>{if(""===e.content)return;C("content"),U(""),h({interaction_goal:"send message in chatbot",interaction_raw_text:null,interfaces_component_type:"chatbot",event_action:"prompt",interfaces_project_id:x,interfaces_page_id:v,embedded_flag:b}),s(e);let{status:o,code:n,predictionId:l}=await S({messages:a.concat(e),[f]:p});if("error"===o){D("content",e.content),U(n);let t={id:l,role:"assistant",content:k.current,message:k.current,error:!0,errorCode:n};r(e,t),_(e,t)}else t(e,{id:l,role:"assistant",content:k.current}),i("")},[C,h,x,v,b,s,S,a,f,p,D,k,r,_,t,i]),P=(0,n.useCallback)(function(){c&&(c.focus(),c.select())},[c]);return(0,n.useEffect)(()=>{I&&(O||j(),P())},[O,I,j,F,P]),(0,o.jsx)(w,{hideZapierButton:g,isDisabled:e,isPopup:y,isSubmitting:V,onEnter:R,onSubmit:T(M),placeholder:m,placeholderWhenSubmitting:l["Chatbot is responding..."],ref:d,register:A,renderPoweredByZapier:z,sendButtonText:l.Send})}function er(){let{defaultMessage:e,isStaticMode:t,triggers:r,badgeSlot:a,botActionsSlot:n,botMessageSlot:s,botResponseSlot:i,containerSlot:u,messagesSlot:d,userMessageSlot:c,copyIconSlot:f,runIconSlot:p}=E();return(0,o.jsxs)(u,{children:[(0,o.jsxs)(d,{children:[(0,o.jsx)(s,{children:(0,o.jsx)(i,{children:t?e:(0,o.jsx)(a,{children:l["Greeting generated from prompt"]})})}),r.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c,{children:(0,o.jsx)(a,{children:l["Prompt input provided to the response above"]})}),(0,o.jsxs)(s,{children:[(0,o.jsx)(i,{children:(0,o.jsx)(a,{children:l["Response generated to the prompt input above"]})}),r.length>0&&(0,o.jsx)(n,{children:r.map(e=>"copy"===e.onClick?(0,o.jsxs)(U,{message:{content:l["This is a demo response"]},disabled:!0,children:[(0,o.jsx)(f,{}),e.buttonText]},e.id):(0,o.jsxs)(R,{message:{content:l["This is a demo response"]},disabled:!0,children:[(0,o.jsx)(p,{}),e.buttonText]},e.id))})]})]}):null]}),(0,o.jsx)(et,{isDisabled:!0})]})}let ea=e=>`If a query does not return sufficient results to answer a user's question, DO NOT APOLOGIZE, DO NOT ATTEMPT TO HELP FURTHER, AND DO NOT EXPLAIN. Respond with exactly the following message: '${e}'`,eo=(0,n.memo)(function(){let{idField:e="blockId",blockId:t,chatbotName:r,chatbotSessionId:a,collectUserData:s,dataSources:i,dataSourcesNoResultsMessage:u,dataSourcesNoResultsMode:d,defaultMessage:c,defaultPrompt:f,directive:p,onEvent:m,isDisabled:h=!1,isStaticMode:g,triggerChatbotBlockAction:b,triggers:y,user:v,containerSlot:x,messagesSlot:z,botActionsSlot:w,botFeedbackSlot:_,botMarkdownSlot:S,botMessageSlot:k,botResponseSlot:A,userMessageSlot:T,copyIconSlot:j,runIconSlot:C}=E(),[F,D]=(0,n.useState)(""),[V,I]=(0,n.useState)(!1),[O,L]=(0,n.useState)([]),M=(0,n.useMemo)(()=>({isDisabled:h,messages:O,onChatComplete(e,t){I(!1),L(e=>[...e,t,{id:Date.now().toString(),role:"user",content:""}])},onError(e,t){I(!1),L(e=>[...e.slice(0,-1),t])},onLiveBotResponseUpdated(e){D(e)},onSubmitPrompt(e){I(!0),L(t=>[...t.slice(0,-1),{...e,id:Date.now().toString()}])}}),[h,O]),[P,N]=(0,n.useState)(!1),[B,q,G]=J();return(0,n.useEffect)(()=>{let e=[{id:Date.now().toString(),role:"system",content:p,message:g?c:void 0,hidden:!g||void 0}];if(i.length>0){let t="Before attempting to respond, you have datasources you can query. When querying, you are ONLY allowed to respond from information provided by the query. You are NOT ALLOWED to introduce information that is not provided in the results. NEVER try and answer from information outside of the results. ";"custom"===d&&(t+=ea(u)),"chatgpt"===d&&(t+="If you do not get relevant results from a query, YOU ARE NOT ALLOWED TO TRY TO ANSWER FROM GENERAL KNOWLEDGE. Instead, simply respond with a message letting the user know that you do not have that information."),e.push({id:`${Date.now().toString()}-datasource`,role:"system",content:t,hidden:!0})}s&&e.push({id:`${Date.now().toString()}-datacollection`,role:"system",content:"WITHOUT EXCEPTION you MUST end your starting message with a prompt for the user to provide you with the information you need to run 'collectUserData'. YOU MUST end your opening message with a variation of 'before we continue, can I ask for your...', to get the information to run this function. Submit the function ONLY AFTER you have collected the info from the user.",hidden:!0}),L(g?[...e,{id:`${Date.now().toString()}-static`,role:"user",content:""}]:[...e,{id:`${Date.now().toString()}-defaultPrompt`,role:"user",content:f,hidden:!0},{id:`${Date.now().toString()}-generated`,role:"assistant",content:""}])},[s,i.length,u,d,c,f,p,g]),(0,n.useEffect)(()=>{async function r(){if(!t)throw Error("expected blockId");try{N(!0);let{status:a,predictionId:o}=await B({messages:O.map(e=>"function"===e.role?{role:e.role,name:e.name,content:e.content}:"user"!==e.role?{id:e.id,role:e.role,content:e.content?e.content:""}:{role:e.role,content:e.content?e.content:""}),[e]:t});"complete"===a?L(e=>[...e.slice(0,-1),{id:o,role:"assistant",content:q.current},{id:Date.now().toString(),role:"user",content:""}]):r()}catch(e){console.error(e),r()}finally{N(!1)}function r(){L([{id:`${Date.now().toString()}-fallback`,role:"system",content:p,message:c},{id:Date.now().toString(),role:"user",content:""}])}}g||2!==O.filter(e=>"system"!==e.role).length||P||r()},[c,p,P,g,t,q,B,v,O,L,e]),(0,o.jsxs)(x,{children:[(0,o.jsxs)(z,{children:[O.map((e,n,s)=>{if(e.hidden)return null;if("user"!==e.role){let i=n>(g?1:3)&&"assistant"===e.role;if(n===s.length-1&&!e.error)return(0,o.jsx)(k,{isLoading:!0,children:(0,o.jsx)(A,{children:G})},e.id);let u=i?s[n-1].content:void 0;return(0,o.jsxs)(k,{isError:e.error,errorCode:e.errorCode,renderFeedback:i?()=>(0,o.jsx)(_,{isSubmitting:V,onFeedback:({rating:r,comment:o})=>{if(!t)throw Error("expected blockId");return m({prediction_id:e.id,correlation_id:a,user_rating:r>0?"EXPLICIT_GOOD":"EXPLICIT_BAD",user_feedback:o??null,corrected_prediction_json_output:null,release_id:null,zap_id:null}),b({type:"ChatbotFeedback",blockId:t,chatbotSessionId:a,values:{rating:r,comment:o,message:e.content,conversation:O.slice(0,n).map(e=>"function"===e.role?{role:e.role,content:e.content,name:e.name}:{role:e.role,content:e.content})}},l["Thanks for the feedback!"])}}):void 0,children:[(0,o.jsx)(A,{"data-testid":"final-bot-response",children:e.content&&!e.message?(0,o.jsx)(S,{children:e.content}):e.message??e.content}),!e.error&&i&&y.length>0&&(0,o.jsx)(w,{children:y.map(t=>"copy"===t.onClick?(0,o.jsxs)(U,{message:e,onClick:()=>{b({type:"ChatbotButtonClick",blockActionId:t.id,values:{response:e.content?e.content:"",chatbotName:r,prompt:u}},t.notificationText)},disabled:V,children:[(0,o.jsx)(j,{}),t.buttonText]},t.id):(0,o.jsxs)(R,{message:e,onClick:()=>{b({type:"ChatbotButtonClick",blockActionId:t.id,values:{response:e.content?e.content:"",chatbotName:r,prompt:u}},t.notificationText)},disabled:V,children:[(0,o.jsx)(C,{}),t.buttonText]},t.id))})]},e.id)}return(0,o.jsx)(T,{children:e.content},e.id)}),V&&(0,o.jsx)(k,{isLoading:!0,children:(0,o.jsx)(A,{children:(0,o.jsx)(S,{children:F})})})]}),(0,o.jsx)(et,{...M})]})}),en=(0,n.memo)(function(e){let t=e.isEditing?er:eo;return(0,o.jsx)(O,{...e,children:(0,o.jsx)(t,{})})})},57203:function(e,t,r){r.d(t,{Dq:function(){return Q},Gc:function(){return v},KN:function(){return O},Qr:function(){return I},RV:function(){return x},U2:function(){return m},bc:function(){return V},cI:function(){return eV},cl:function(){return T},t8:function(){return R}});var a=r(66970),o=e=>"checkbox"===e.type,n=e=>e instanceof Date,s=e=>null==e;let i=e=>"object"==typeof e;var l=e=>!s(e)&&!Array.isArray(e)&&i(e)&&!n(e),u=e=>l(e)&&e.target?o(e.target)?e.target.checked:e.target.value:e,d=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,c=(e,t)=>e.has(d(t)),f=e=>Array.isArray(e)?e.filter(Boolean):[],p=e=>void 0===e,m=(e,t,r)=>{if(!t||!l(e))return r;let a=f(t.split(/[,[\].]+?/)).reduce((e,t)=>s(e)?e:e[t],e);return p(a)||a===e?p(e[t])?r:e[t]:a};let h={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},g={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},b={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},y=a.createContext(null),v=()=>a.useContext(y),x=e=>{let{children:t,...r}=e;return a.createElement(y.Provider,{value:r},t)};var z=(e,t,r,a=!0)=>{let o={};for(let n in e)Object.defineProperty(o,n,{get:()=>{let o=n;return t[o]!==g.all&&(t[o]=!a||g.all),r&&(r[o]=!0),e[o]}});return o},w=e=>l(e)&&!Object.keys(e).length,_=(e,t,r)=>{let{name:a,...o}=e;return w(o)||Object.keys(o).length>=Object.keys(t).length||Object.keys(o).find(e=>t[e]===(!r||g.all))},S=e=>Array.isArray(e)?e:[e],k=(e,t,r)=>r&&t?e===t:!e||!t||e===t||S(e).some(e=>e&&(e.startsWith(t)||t.startsWith(e)));function A(e){let t=a.useRef(e);t.current=e,a.useEffect(()=>{let r=e=>{e&&e.unsubscribe()},a=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>r(a)},[e.disabled])}function T(e){let t=v(),{control:r=t.control,disabled:o,name:n,exact:s}=e||{},[i,l]=a.useState(r._formState),u=a.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=a.useRef(n),c=a.useRef(!0);d.current=n;let f=a.useCallback(e=>c.current&&k(d.current,e.name,s)&&_(e,u.current)&&l({...r._formState,...e}),[r,s]);return A({disabled:o,callback:f,subject:r._subjects.state}),a.useEffect(()=>(c.current=!0,()=>{c.current=!1}),[]),z(i,r._proxyFormState,u.current,!1)}var j=e=>"string"==typeof e,C=(e,t,r,a)=>{let o=Array.isArray(e);return j(e)?(a&&t.watch.add(e),m(r,e)):o?e.map(e=>(a&&t.watch.add(e),m(r,e))):(a&&(t.watchAll=!0),r)},F=e=>"function"==typeof e,D=e=>{for(let t in e)if(F(e[t]))return!0;return!1};function V(e){let t=v(),{name:r,control:o=t.control,shouldUnregister:n}=e,s=c(o._names.array,r),i=function(e){let t=v(),{control:r=t.control,name:o,defaultValue:n,disabled:s,exact:i}=e||{},u=a.useRef(o);u.current=o;let d=a.useCallback(e=>{if(k(u.current,e.name,i)){let t=C(u.current,r._names,e.values||r._formValues);f(p(u.current)||l(t)&&!D(t)?{...t}:Array.isArray(t)?[...t]:p(t)?n:t)}},[r,i,n]);A({disabled:s,subject:r._subjects.watch,callback:d});let[c,f]=a.useState(p(n)?r._getWatch(o):n);return a.useEffect(()=>{r._removeUnmounted()}),c}({control:o,name:r,defaultValue:m(o._formValues,r,m(o._defaultValues,r,e.defaultValue)),exact:!0}),d=T({control:o,name:r}),f=a.useRef(o.register(r,{...e.rules,value:i}));return a.useEffect(()=>{let e=(e,t)=>{let r=m(o._fields,e);r&&(r._f.mount=t)};return e(r,!0),()=>{let t=o._options.shouldUnregister||n;(s?t&&!o._stateFlags.action:t)?o.unregister(r):e(r,!1)}},[r,o,s,n]),{field:{name:r,value:i,onChange:a.useCallback(e=>{f.current.onChange({target:{value:u(e),name:r},type:h.CHANGE})},[r]),onBlur:a.useCallback(()=>{f.current.onBlur({target:{value:m(o._formValues,r),name:r},type:h.BLUR})},[r,o]),ref:a.useCallback(e=>{let t=m(o._fields,r);e&&t&&e.focus&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})},[r,o._fields])},formState:d,fieldState:Object.defineProperties({},{invalid:{get:()=>!!m(d.errors,r)},isDirty:{get:()=>!!m(d.dirtyFields,r)},isTouched:{get:()=>!!m(d.touchedFields,r)},error:{get:()=>m(d.errors,r)}})}}let I=e=>e.render(V(e));var O=(e,t,r,a,o)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[a]:o||!0}}:{},E=e=>/^\w*$/.test(e),U=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function R(e,t,r){let a=-1,o=E(t)?[t]:U(t),n=o.length,s=n-1;for(;++a<n;){let t=o[a],n=r;if(a!==s){let r=e[t];n=l(r)||Array.isArray(r)?r:isNaN(+o[a+1])?{}:[]}e[t]=n,e=e[t]}return e}let L=(e,t,r)=>{for(let a of r||Object.keys(e)){let r=m(e,a);if(r){let{_f:e,...a}=r;if(e&&t(e.name)){if(e.ref.focus&&p(e.ref.focus()))break;if(e.refs){e.refs[0].focus();break}}else l(a)&&L(a,t)}}};var M=()=>{let e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let r=(16*Math.random()+e)%16|0;return("x"==t?r:3&r|8).toString(16)})},P=(e,t,r={})=>r.shouldFocus||p(r.shouldFocus)?r.focusName||`${e}.${p(r.focusIndex)?t:r.focusIndex}.`:"",N=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));function B(e,t){return[...e,...S(t)]}var q="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function G(e){let t;let r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(!(q&&(e instanceof Blob||e instanceof FileList))&&(r||l(e))))return e;else for(let a in t=r?[]:{},e){if(F(e[a])){t=e;break}t[a]=G(e[a])}return t}var Y=e=>Array.isArray(e)?e.map(()=>void 0):void 0;function Z(e,t,r){return[...e.slice(0,t),...S(r),...e.slice(t)]}var $=(e,t,r)=>Array.isArray(e)?(p(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[];function W(e,t){return[...S(t),...S(e)]}var H=(e,t)=>p(t)?[]:function(e,t){let r=0,a=[...e];for(let e of t)a.splice(e-r,1),r++;return f(a).length?a:[]}(e,S(t).sort((e,t)=>e-t)),K=(e,t,r)=>{e[t]=[e[r],e[r]=e[t]][0]};function X(e,t){let r;let a=E(t)?[t]:U(t),o=1==a.length?e:function(e,t){let r=t.slice(0,-1).length,a=0;for(;a<r;)e=p(e)?a++:e[t[a++]];return e}(e,a),n=a[a.length-1];o&&delete o[n];for(let t=0;t<a.slice(0,-1).length;t++){let o,n=-1,s=a.slice(0,-(t+1)),i=s.length-1;for(t>0&&(r=e);++n<s.length;){let t=s[n];o=o?o[t]:e[t],i===n&&(l(o)&&w(o)||Array.isArray(o)&&!o.filter(e=>!p(e)).length)&&(r?delete r[t]:delete e[t]),r=o}}return e}var J=(e,t,r)=>(e[t]=r,e);function Q(e){let t=v(),{control:r=t.control,name:o,keyName:n="id",shouldUnregister:s}=e,[i,l]=a.useState(r._getFieldArray(o)),u=a.useRef(r._getFieldArray(o).map(M)),d=a.useRef(i),c=a.useRef(o),f=a.useRef(!1);c.current=o,d.current=i,r._names.array.add(o);let p=a.useCallback(({values:e,name:t})=>{if(t===c.current||!t){let t=m(e,c.current,[]);l(t),u.current=t.map(M)}},[]);A({callback:p,subject:r._subjects.array});let h=a.useCallback(e=>{f.current=!0,r._updateFieldArray(o,e)},[r,o]),g=(e,t)=>{let a=S(G(e)),n=B(r._getFieldArray(o),a);r._names.focus=P(o,n.length-1,t),u.current=B(u.current,a.map(M)),h(n),l(n),r._updateFieldArray(o,n,B,{argA:Y(e)})},b=(e,t)=>{let a=S(G(e)),n=W(r._getFieldArray(o),a);r._names.focus=P(o,0,t),u.current=W(u.current,a.map(M)),h(n),l(n),r._updateFieldArray(o,n,W,{argA:Y(e)})},y=e=>{let t=H(r._getFieldArray(o),e);u.current=H(u.current,e),h(t),l(t),r._updateFieldArray(o,t,H,{argA:e})},x=(e,t,a)=>{let n=S(G(t)),s=Z(r._getFieldArray(o),e,n);r._names.focus=P(o,e,a),u.current=Z(u.current,e,n.map(M)),h(s),l(s),r._updateFieldArray(o,s,Z,{argA:e,argB:Y(t)})},z=(e,t)=>{let a=r._getFieldArray(o);K(a,e,t),K(u.current,e,t),h(a),l(a),r._updateFieldArray(o,a,K,{argA:e,argB:t},!1)},w=(e,t)=>{let a=r._getFieldArray(o);$(a,e,t),$(u.current,e,t),h(a),l(a),r._updateFieldArray(o,a,$,{argA:e,argB:t},!1)},_=(e,t)=>{let a=G(t),n=J(r._getFieldArray(o),e,a);u.current=[...n].map((t,r)=>t&&r!==e?u.current[r]:M()),h(n),l([...n]),r._updateFieldArray(o,n,J,{argA:e,argB:a},!0,!1)},k=e=>{let t=S(G(e));u.current=t.map(M),h([...t]),l([...t]),r._updateFieldArray(o,[...t],e=>e,{},!0,!1)};return a.useEffect(()=>{r._stateFlags.action=!1,N(o,r._names)&&r._subjects.state.next({}),f.current&&r._executeSchema([o]).then(e=>{let t=m(e.errors,o),a=m(r._formState.errors,o);(a?!t&&a.type:t&&t.type)&&(t?R(r._formState.errors,o,t):X(r._formState.errors,o),r._subjects.state.next({errors:r._formState.errors}))}),r._subjects.watch.next({name:o,values:r._formValues}),r._names.focus&&L(r._fields,e=>e.startsWith(r._names.focus)),r._names.focus="",r._proxyFormState.isValid&&r._updateValid()},[i,o,r]),a.useEffect(()=>(m(r._formValues,o)||r._updateFieldArray(o),()=>{(r._options.shouldUnregister||s)&&r.unregister(o)}),[o,r,n,s]),{swap:a.useCallback(z,[h,o,r]),move:a.useCallback(w,[h,o,r]),prepend:a.useCallback(b,[h,o,r]),append:a.useCallback(g,[h,o,r]),remove:a.useCallback(y,[h,o,r]),insert:a.useCallback(x,[h,o,r]),update:a.useCallback(_,[h,o,r]),replace:a.useCallback(k,[h,o,r]),fields:a.useMemo(()=>i.map((e,t)=>({...e,[n]:u.current[t]||M()})),[i,n])}}function ee(){let e=[],t=t=>{for(let r of e)r.next(t)},r=t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),a=()=>{e=[]};return{get observers(){return e},next:t,subscribe:r,unsubscribe:a}}var et=e=>s(e)||!i(e);function er(e,t){if(et(e)||et(t))return e===t;if(n(e)&&n(t))return e.getTime()===t.getTime();let r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(let o of r){let r=e[o];if(!a.includes(o))return!1;if("ref"!==o){let e=t[o];if(n(r)&&n(e)||l(r)&&l(e)||Array.isArray(r)&&Array.isArray(e)?!er(r,e):r!==e)return!1}}return!0}var ea=e=>({isOnSubmit:!e||e===g.onSubmit,isOnBlur:e===g.onBlur,isOnChange:e===g.onChange,isOnAll:e===g.all,isOnTouch:e===g.onTouched}),eo=e=>"boolean"==typeof e,en=e=>"file"===e.type,es=e=>{let t=e?e.ownerDocument:0,r=t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement;return e instanceof r},ei=e=>"select-multiple"===e.type,el=e=>"radio"===e.type,eu=e=>el(e)||o(e),ed=e=>es(e)&&e.isConnected;function ec(e,t={}){let r=Array.isArray(e);if(l(e)||r)for(let r in e)Array.isArray(e[r])||l(e[r])&&!D(e[r])?(t[r]=Array.isArray(e[r])?[]:{},ec(e[r],t[r])):s(e[r])||(t[r]=!0);return t}var ef=(e,t)=>(function e(t,r,a){let o=Array.isArray(t);if(l(t)||o)for(let o in t)Array.isArray(t[o])||l(t[o])&&!D(t[o])?p(r)||et(a[o])?a[o]=Array.isArray(t[o])?ec(t[o],[]):{...ec(t[o])}:e(t[o],s(r)?{}:r[o],a[o]):a[o]=!er(t[o],r[o]);return a})(e,t,ec(t));let ep={value:!1,isValid:!1},em={value:!0,isValid:!0};var eh=e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!p(e[0].attributes.value)?p(e[0].value)||""===e[0].value?em:{value:e[0].value,isValid:!0}:em:ep}return ep},eg=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:a})=>p(e)?e:t?""===e||s(e)?NaN:+e:r&&j(e)?new Date(e):a?a(e):e;let eb={isValid:!1,value:null};var ey=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,eb):eb;function ev(e){let t=e.ref;return(e.refs?e.refs.every(e=>e.disabled):t.disabled)?void 0:en(t)?t.files:el(t)?ey(e.refs).value:ei(t)?[...t.selectedOptions].map(({value:e})=>e):o(t)?eh(e.refs).value:eg(p(t.value)?e.ref.value:t.value,e)}var ex=(e,t,r,a)=>{let o={};for(let r of e){let e=m(t,r);e&&R(o,r,e._f)}return{criteriaMode:r,names:[...e],fields:o,shouldUseNativeValidation:a}},ez=e=>e instanceof RegExp,ew=e=>p(e)?void 0:ez(e)?e.source:l(e)?ez(e.value)?e.value.source:e.value:e,e_=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function eS(e,t,r){let a=m(e,r);if(a||E(r))return{error:a,name:r};let o=r.split(".");for(;o.length;){let a=o.join("."),n=m(t,a),s=m(e,a);if(n&&!Array.isArray(n)&&r!==a)break;if(s&&s.type)return{name:a,error:s};o.pop()}return{name:r}}var ek=(e,t,r,a,o)=>!o.isOnAll&&(!r&&o.isOnTouch?!(t||e):(r?a.isOnBlur:o.isOnBlur)?!e:(r?!a.isOnChange:!o.isOnChange)||e),eA=(e,t)=>!f(m(e,t)).length&&X(e,t),eT=e=>j(e)||a.isValidElement(e);function ej(e,t,r="validate"){if(eT(e)||Array.isArray(e)&&e.every(eT)||eo(e)&&!e)return{type:r,message:eT(e)?e:"",ref:t}}var eC=e=>l(e)&&!ez(e)?e:{value:e,message:""},eF=async(e,t,r,a)=>{let{ref:n,refs:i,required:u,maxLength:d,minLength:c,min:f,max:p,pattern:m,validate:h,name:g,valueAsNumber:y,mount:v,disabled:x}=e._f;if(!v||x)return{};let z=i?i[0]:n,_=e=>{a&&z.reportValidity&&(z.setCustomValidity(eo(e)?"":e||" "),z.reportValidity())},S={},k=el(n),A=o(n),T=(y||en(n))&&!n.value||""===t||Array.isArray(t)&&!t.length,C=O.bind(null,g,r,S),D=(e,t,r,a=b.maxLength,o=b.minLength)=>{let s=e?t:r;S[g]={type:e?a:o,message:s,ref:n,...C(e?a:o,s)}};if(u&&(!(k||A)&&(T||s(t))||eo(t)&&!t||A&&!eh(i).isValid||k&&!ey(i).isValid)){let{value:e,message:t}=eT(u)?{value:!!u,message:u}:eC(u);if(e&&(S[g]={type:b.required,message:t,ref:z,...C(b.required,t)},!r))return _(t),S}if(!T&&(!s(f)||!s(p))){let e,a;let o=eC(p),i=eC(f);if(s(t)||isNaN(t)){let r=n.valueAsDate||new Date(t);j(o.value)&&(e=r>new Date(o.value)),j(i.value)&&(a=r<new Date(i.value))}else{let r=n.valueAsNumber||+t;s(o.value)||(e=r>o.value),s(i.value)||(a=r<i.value)}if((e||a)&&(D(!!e,o.message,i.message,b.max,b.min),!r))return _(S[g].message),S}if((d||c)&&!T&&j(t)){let e=eC(d),a=eC(c),o=!s(e.value)&&t.length>e.value,n=!s(a.value)&&t.length<a.value;if((o||n)&&(D(o,e.message,a.message),!r))return _(S[g].message),S}if(m&&!T&&j(t)){let{value:e,message:a}=eC(m);if(ez(e)&&!t.match(e)&&(S[g]={type:b.pattern,message:a,ref:n,...C(b.pattern,a)},!r))return _(a),S}if(h){if(F(h)){let e=await h(t),a=ej(e,z);if(a&&(S[g]={...a,...C(b.validate,a.message)},!r))return _(a.message),S}else if(l(h)){let e={};for(let a in h){if(!w(e)&&!r)break;let o=ej(await h[a](t),z,a);o&&(e={...o,...C(a,o.message)},_(o.message),r&&(S[g]=e))}if(!w(e)&&(S[g]={ref:z,...e},!r))return S}}return _(!0),S};let eD={mode:g.onSubmit,reValidateMode:g.onChange,shouldFocusError:!0};function eV(e={}){let t=a.useRef(),[r,i]=a.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}});t.current?t.current.control._options=e:t.current={...function(e={}){let t,r={...eD,...e},a={isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}},i={},l=G(r.defaultValues)||{},d=r.shouldUnregister?{}:G(l),b={action:!1,mount:!1,watch:!1},y={mount:new Set,unMount:new Set,array:new Set,watch:new Set},v=0,x={},z={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},_={watch:ee(),array:ee(),state:ee()},k=ea(r.mode),A=ea(r.reValidateMode),T=r.criteriaMode===g.all,D=e=>t=>{clearTimeout(v),v=window.setTimeout(e,t)},V=async e=>{let t=!1;return z.isValid&&(t=r.resolver?w((await P()).errors):await Y(i,!0),e||t===a.isValid||(a.isValid=t,_.state.next({isValid:t}))),t},I=(e,t=[],r,o,n=!0,s=!0)=>{if(o&&r){if(b.action=!0,s&&Array.isArray(m(i,e))){let t=r(m(i,e),o.argA,o.argB);n&&R(i,e,t)}if(z.errors&&s&&Array.isArray(m(a.errors,e))){let t=r(m(a.errors,e),o.argA,o.argB);n&&R(a.errors,e,t),eA(a.errors,e)}if(z.touchedFields&&s&&Array.isArray(m(a.touchedFields,e))){let t=r(m(a.touchedFields,e),o.argA,o.argB);n&&R(a.touchedFields,e,t)}z.dirtyFields&&(a.dirtyFields=ef(l,d)),_.state.next({isDirty:$(e,t),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else R(d,e,t)},O=(e,t)=>{R(a.errors,e,t),_.state.next({errors:a.errors})},E=(e,t,r,a)=>{let o=m(i,e);if(o){let n=m(d,e,p(r)?m(l,e):r);p(n)||a&&a.defaultChecked||t?R(d,e,t?n:ev(o._f)):K(e,n),b.mount&&V()}},U=(e,t,r,o,n)=>{let s=!1,i={name:e},u=m(a.touchedFields,e);if(z.isDirty){let e=a.isDirty;a.isDirty=i.isDirty=$(),s=e!==i.isDirty}if(z.dirtyFields&&(!r||o)){let r=m(a.dirtyFields,e),o=er(m(l,e),t);o?X(a.dirtyFields,e):R(a.dirtyFields,e,!0),i.dirtyFields=a.dirtyFields,s=s||r!==m(a.dirtyFields,e)}return r&&!u&&(R(a.touchedFields,e,r),i.touchedFields=a.touchedFields,s=s||z.touchedFields&&u!==r),s&&n&&_.state.next(i),s?i:{}},M=async(r,o,n,s)=>{let i=m(a.errors,r),l=z.isValid&&a.isValid!==o;if(e.delayError&&n?(t=D(()=>O(r,n)))(e.delayError):(clearTimeout(v),t=null,n?R(a.errors,r,n):X(a.errors,r)),(n?!er(i,n):i)||!w(s)||l){let e={...s,...l?{isValid:o}:{},errors:a.errors,name:r};a={...a,...e},_.state.next(e)}x[r]--,z.isValidating&&!Object.values(x).some(e=>e)&&(_.state.next({isValidating:!1}),x={})},P=async e=>r.resolver?await r.resolver({...d},r.context,ex(e||y.mount,i,r.criteriaMode,r.shouldUseNativeValidation)):{},B=async e=>{let{errors:t}=await P();if(e)for(let r of e){let e=m(t,r);e?R(a.errors,r,e):X(a.errors,r)}else a.errors=t;return t},Y=async(e,t,o={valid:!0})=>{for(let n in e){let s=e[n];if(s){let{_f:e,...n}=s;if(e){let n=await eF(s,m(d,e.name),T,r.shouldUseNativeValidation);if(n[e.name]&&(o.valid=!1,t))break;t||(n[e.name]?R(a.errors,e.name,n[e.name]):X(a.errors,e.name))}n&&await Y(n,t,o)}}return o.valid},Z=()=>{for(let e of y.unMount){let t=m(i,e);t&&(t._f.refs?t._f.refs.every(e=>!ed(e)):!ed(t._f.ref))&&ez(e)}y.unMount=new Set},$=(e,t)=>(e&&t&&R(d,e,t),!er(ep(),l)),W=(e,t,r)=>{let a={...b.mount?d:p(t)?l:j(e)?{[e]:t}:t};return C(e,y,a,r)},H=t=>f(m(b.mount?d:l,t,e.shouldUnregister?m(l,t,[]):[])),K=(e,t,r={})=>{let a=m(i,e),n=t;if(a){let r=a._f;r&&(r.disabled||R(d,e,eg(t,r)),n=q&&es(r.ref)&&s(t)?"":t,ei(r.ref)?[...r.ref.options].forEach(e=>e.selected=n.includes(e.value)):r.refs?o(r.ref)?r.refs.length>1?r.refs.forEach(e=>!e.disabled&&(e.checked=Array.isArray(n)?!!n.find(t=>t===e.value):n===e.value)):r.refs[0]&&(r.refs[0].checked=!!n):r.refs.forEach(e=>e.checked=e.value===n):en(r.ref)?r.ref.value="":(r.ref.value=n,r.ref.type||_.watch.next({name:e})))}(r.shouldDirty||r.shouldTouch)&&U(e,n,r.shouldTouch,r.shouldDirty,!0),r.shouldValidate&&ec(e)},J=(e,t,r)=>{for(let a in t){let o=t[a],s=`${e}.${a}`,l=m(i,s);!y.array.has(e)&&et(o)&&(!l||l._f)||n(o)?K(s,o,r):J(s,o,r)}},Q=(e,t,r={})=>{let o=m(i,e),n=y.array.has(e),u=G(t);R(d,e,u),n?(_.array.next({name:e,values:d}),(z.isDirty||z.dirtyFields)&&r.shouldDirty&&(a.dirtyFields=ef(l,d),_.state.next({name:e,dirtyFields:a.dirtyFields,isDirty:$(e,u)}))):!o||o._f||s(u)?K(e,u,r):J(e,u,r),N(e,y)&&_.state.next({}),_.watch.next({name:e})},el=async e=>{let o=e.target,n=o.name,s=m(i,n);if(s){let l,c;let f=o.type?ev(s._f):u(e),p=e.type===h.BLUR||e.type===h.FOCUS_OUT,g=!e_(s._f)&&!r.resolver&&!m(a.errors,n)&&!s._f.deps||ek(p,m(a.touchedFields,n),a.isSubmitted,A,k),b=N(n,y,p);R(d,n,f),p?(s._f.onBlur&&s._f.onBlur(e),t&&t(0)):s._f.onChange&&s._f.onChange(e);let v=U(n,f,p,!1),z=!w(v)||b;if(p||_.watch.next({name:n,type:e.type}),g)return z&&_.state.next({name:n,...b?{}:v});if(!p&&b&&_.state.next({}),x[n]=(x[n],1),_.state.next({isValidating:!0}),r.resolver){let{errors:e}=await P([n]),t=eS(a.errors,i,n),r=eS(e,i,t.name||n);l=r.error,n=r.name,c=w(e)}else l=(await eF(s,m(d,n),T,r.shouldUseNativeValidation))[n],c=await V(!0);s._f.deps&&ec(s._f.deps),M(n,c,l,v)}},ec=async(e,t={})=>{let o,n;let s=S(e);if(_.state.next({isValidating:!0}),r.resolver){let t=await B(p(e)?e:s);o=w(t),n=e?!s.some(e=>m(t,e)):o}else e?((n=(await Promise.all(s.map(async e=>{let t=m(i,e);return await Y(t&&t._f?{[e]:t}:t)}))).every(Boolean))||a.isValid)&&V():n=o=await Y(i);return _.state.next({...!j(e)||z.isValid&&o!==a.isValid?{}:{name:e},...r.resolver?{isValid:o}:{},errors:a.errors,isValidating:!1}),t.shouldFocus&&!n&&L(i,e=>m(a.errors,e),e?s:y.mount),n},ep=e=>{let t={...l,...b.mount?d:{}};return p(e)?t:j(e)?m(t,e):e.map(e=>m(t,e))},em=(e,t)=>({invalid:!!m((t||a).errors,e),isDirty:!!m((t||a).dirtyFields,e),isTouched:!!m((t||a).touchedFields,e),error:m((t||a).errors,e)}),eh=e=>{e?S(e).forEach(e=>X(a.errors,e)):a.errors={},_.state.next({errors:a.errors})},eb=(e,t,r)=>{let o=(m(i,e,{_f:{}})._f||{}).ref;R(a.errors,e,{...t,ref:o}),_.state.next({name:e,errors:a.errors,isValid:!1}),r&&r.shouldFocus&&o&&o.focus&&o.focus()},ey=(e,t)=>F(e)?_.watch.subscribe({next:r=>e(W(void 0,t),r)}):W(e,t,!0),ez=(e,t={})=>{for(let o of e?S(e):y.mount)y.mount.delete(o),y.array.delete(o),m(i,o)&&(t.keepValue||(X(i,o),X(d,o)),t.keepError||X(a.errors,o),t.keepDirty||X(a.dirtyFields,o),t.keepTouched||X(a.touchedFields,o),r.shouldUnregister||t.keepDefaultValue||X(l,o));_.watch.next({}),_.state.next({...a,...t.keepDirty?{isDirty:$()}:{}}),t.keepIsValid||V()},eT=(e,t={})=>{let a=m(i,e),o=eo(t.disabled);return R(i,e,{_f:{...a&&a._f?a._f:{ref:{name:e}},name:e,mount:!0,...t}}),y.mount.add(e),a?o&&R(d,e,t.disabled?void 0:m(d,e,ev(a._f))):E(e,!0,t.value),{...o?{disabled:t.disabled}:{},...r.shouldUseNativeValidation?{required:!!t.required,min:ew(t.min),max:ew(t.max),minLength:ew(t.minLength),maxLength:ew(t.maxLength),pattern:ew(t.pattern)}:{},name:e,onChange:el,onBlur:el,ref:o=>{if(o){eT(e,t),a=m(i,e);let r=p(o.value)&&o.querySelectorAll&&o.querySelectorAll("input,select,textarea")[0]||o,n=eu(r),s=a._f.refs||[];(n?s.find(e=>e===r):r===a._f.ref)||(R(i,e,{_f:{...a._f,...n?{refs:[...s.filter(ed),r,...Array.isArray(m(l,e))?[{}]:[]],ref:{type:r.type,name:e}}:{ref:r}}}),E(e,!1,void 0,r))}else(a=m(i,e,{}))._f&&(a._f.mount=!1),(r.shouldUnregister||t.shouldUnregister)&&!(c(y.array,e)&&b.action)&&y.unMount.add(e)}}},ej=(e,t)=>async o=>{o&&(o.preventDefault&&o.preventDefault(),o.persist&&o.persist());let n=!0,s=G(d);_.state.next({isSubmitting:!0});try{if(r.resolver){let{errors:e,values:t}=await P();a.errors=e,s=t}else await Y(i);w(a.errors)?(_.state.next({errors:{},isSubmitting:!0}),await e(s,o)):(t&&await t({...a.errors},o),r.shouldFocusError&&L(i,e=>m(a.errors,e),y.mount))}catch(e){throw n=!1,e}finally{a.isSubmitted=!0,_.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:w(a.errors)&&n,submitCount:a.submitCount+1,errors:a.errors})}},eC=(e,t={})=>{m(i,e)&&(p(t.defaultValue)?Q(e,m(l,e)):(Q(e,t.defaultValue),R(l,e,t.defaultValue)),t.keepTouched||X(a.touchedFields,e),t.keepDirty||(X(a.dirtyFields,e),a.isDirty=t.defaultValue?$(e,m(l,e)):$()),!t.keepError&&(X(a.errors,e),z.isValid&&V()),_.state.next({...a}))},eV=(t,r={})=>{let o=t||l,n=G(o),s=t&&!w(t)?n:l;if(r.keepDefaultValues||(l=o),!r.keepValues){if(r.keepDirtyValues)for(let e of y.mount)m(a.dirtyFields,e)?R(s,e,m(d,e)):Q(e,m(s,e));else{if(q&&p(t))for(let e of y.mount){let t=m(i,e);if(t&&t._f){let e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;try{es(e)&&e.closest("form").reset();break}catch(e){}}}i={}}d=e.shouldUnregister?r.keepDefaultValues?G(l):{}:n,_.array.next({values:s}),_.watch.next({values:s})}y={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},b.mount=!z.isValid||!!r.keepIsValid,b.watch=!!e.shouldUnregister,_.state.next({submitCount:r.keepSubmitCount?a.submitCount:0,isDirty:r.keepDirty||r.keepDirtyValues?a.isDirty:!!(r.keepDefaultValues&&!er(t,l)),isSubmitted:!!r.keepIsSubmitted&&a.isSubmitted,dirtyFields:r.keepDirty||r.keepDirtyValues?a.dirtyFields:r.keepDefaultValues&&t?ef(l,t):{},touchedFields:r.keepTouched?a.touchedFields:{},errors:r.keepErrors?a.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},eI=(e,t={})=>{let r=m(i,e)._f,a=r.refs?r.refs[0]:r.ref;a.focus(),t.shouldSelect&&a.select()};return{control:{register:eT,unregister:ez,getFieldState:em,_executeSchema:P,_getWatch:W,_getDirty:$,_updateValid:V,_removeUnmounted:Z,_updateFieldArray:I,_getFieldArray:H,_subjects:_,_proxyFormState:z,get _fields(){return i},get _formValues(){return d},get _stateFlags(){return b},set _stateFlags(value){b=value},get _defaultValues(){return l},get _names(){return y},set _names(value){y=value},get _formState(){return a},set _formState(value){a=value},get _options(){return r},set _options(value){r={...r,...value}}},trigger:ec,register:eT,handleSubmit:ej,watch:ey,setValue:Q,getValues:ep,reset:eV,resetField:eC,clearErrors:eh,unregister:ez,setError:eb,setFocus:eI,getFieldState:em}}(e),formState:r};let l=t.current.control,d=a.useCallback(e=>{_(e,l._proxyFormState,!0)&&(l._formState={...l._formState,...e},i({...l._formState}))},[l]);return A({subject:l._subjects.state,callback:d}),a.useEffect(()=>{l._stateFlags.mount||(l._proxyFormState.isValid&&l._updateValid(),l._stateFlags.mount=!0),l._stateFlags.watch&&(l._stateFlags.watch=!1,l._subjects.state.next({})),l._removeUnmounted()}),t.current.formState=z(r,l._proxyFormState),t.current}}}]);
//# sourceMappingURL=2403-d69c8426a093b3ba.js.map